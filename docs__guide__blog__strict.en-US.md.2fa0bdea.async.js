(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[22],{"3Gr2":function(e,t,n){"use strict";n.r(t);var a=n("3Nsx"),o=n.n(a),r=n("C8qh"),c=n("sBO+"),l=o.a.memo((e=>{e.demos;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"markdown"},o.a.createElement("h1",{id:"react-hooks--strict-mode"},o.a.createElement(r["AnchorLink"],{to:"#react-hooks--strict-mode","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"React Hooks & strict mode"),o.a.createElement("h2",{id:"what-is-strict-mode"},o.a.createElement(r["AnchorLink"],{to:"#what-is-strict-mode","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"What is strict mode"),o.a.createElement("p",null,"In React, there are many historical APIs or writing methods that will be obsolete in future versions and are now marked as deprecated. such as ",o.a.createElement("code",null,"componentWillMount"),", in normal mode, you can use it normally. But in strict mode, a warning will be thrown:"),o.a.createElement("p",null,o.a.createElement("img",{src:"https://user-images.githubusercontent.com/12526493/140928679-cafd5b58-2937-41a9-87e8-f68aa6d978d9.png",alt:"image.png"})),o.a.createElement("p",null,"So ",o.a.createElement("strong",null,"strict mode is for future development, all APIs or writing methods that are not recommended will throw warnings (only effective in development mode).")),o.a.createElement("p",null,"We can use ",o.a.createElement("code",null,"React.StrictMode")," to enable strict mode."),o.a.createElement(c["a"],{code:"import React from 'react';\n\nfunction ExampleApplication() {\n  return (\n    <div>\n      <Header />\n      <React.StrictMode>\n        <div>\n          <ComponentOne />\n          <ComponentTwo />\n        </div>\n      </React.StrictMode>\n      <Footer />\n    </div>\n  );\n}",lang:"javascript"}),o.a.createElement("p",null,'For more documents, please refer to "',o.a.createElement(r["Link"],{to:"https://reactjs.org/docs/strict-mode.html"},"Strict Mode"),'"'),o.a.createElement("h2",{id:"points-to-note-in-react-hooks"},o.a.createElement(r["AnchorLink"],{to:"#points-to-note-in-react-hooks","aria-hidden":"true",tabIndex:-1},o.a.createElement("span",{className:"icon icon-link"})),"Points to note in React Hooks"),o.a.createElement("p",null,'One of the most important capabilities of strict mode is "',o.a.createElement(r["Link"],{to:"https://reactjs.org/docs/strict-mode.html#detecting-unexpected-side-effects"},"Detecting Unexpected Side Effects"),'", in the upcoming concurrent mode, the component is divided into two phases:'),o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement("strong",null,"Render phase"),": Generate DOM tree, will execute constructor, componentWillMount, componentWillReceiveProps, componentWillUpdate, getDerivedStateFromProps, shouldComponentUpdate, render, ",o.a.createElement("strong",null,"useState, useMemo, useCallback")," and other life cycles"),o.a.createElement("li",null,o.a.createElement("strong",null,"Commit stage"),": Apply DOM changes, trigger componentDidMount, componentDidUpdate, ",o.a.createElement("strong",null,"useEffect")," and other life cycles")),o.a.createElement("p",null,"Generally, the render phase is time-consuming, and the commit phase is executed quickly. Therefore, in the upcoming concurrent mode, the render phase may be suspended and re-executed. That is, the life cycle of the rendering phase may be executed multiple times."),o.a.createElement(c["a"],{code:"constructor(){\n  services.getUserInfo().then(() => {\n    .....\n  });\n}",lang:"javascript"}),o.a.createElement("p",null,"As above, if we initiate a network request in the constructor, it may be executed multiple times. So ",o.a.createElement("strong",null,"do not perform operations with side effects during the render phase.")),o.a.createElement("p",null,"But if you perform side-effect operations during the rendering phase, React will not be able to perceive it. ",o.a.createElement("strong",null,"But in strict mode, React will intentionally repeat the render phase method, making it easier for us to find such bugs in the development phase")," (not all the life cycles of the rendering phase will be re-executed, see ",o.a.createElement(r["Link"],{to:"https://reactjs.org/docs/strict-mode.html#detecting-unexpected-side-effects"},"Official Documentation"),")."),o.a.createElement(c["a"],{code:"const useTest = () => {\n  const [state, setState] = useState(() => {\n    console.log('get state');\n    return 'state';\n  });\n\n  const memoState = useMemo(() => {\n    console.log('get memo state');\n    return 'state';\n  }, []);\n\n  console.log('render');\n\n  return state;\n};",lang:"javascript"}),o.a.createElement("p",null,"In the above code, the first parameter of ",o.a.createElement("code",null,"useState"),", ",o.a.createElement("code",null,"useMemo")," and the Hook function body are all executed twice."),o.a.createElement("p",null,o.a.createElement(r["Link"],{to:"https://codesandbox.io/s/xvv55893mp?file=/src/index.js"},"Demo")),o.a.createElement("p",null,"Please remember the conclusion: ",o.a.createElement("strong",null,"In strict mode, the first parameter of ",o.a.createElement("code",null,"useState"),", ",o.a.createElement("code",null,"useMemo"),", ",o.a.createElement("code",null,"useReducer")," and the Hook function body will be executed twice. Do not perform operations with side effects here."))))}));t["default"]=e=>{var t=o.a.useContext(r["context"]),n=t.demos;return o.a.useEffect((()=>{var t;null!==e&&void 0!==e&&null!==(t=e.location)&&void 0!==t&&t.hash&&r["AnchorLink"].scrollToAnchor(decodeURIComponent(e.location.hash.slice(1)))}),[]),o.a.createElement(l,{demos:n})}}}]);